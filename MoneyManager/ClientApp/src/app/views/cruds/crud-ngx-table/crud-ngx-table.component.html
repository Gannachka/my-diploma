<div class="m-333">
  <!-- <span fxFlex></span> -->
  <button *ngIf="getUserRole() === 'User'" mat-raised-button class="mb-8" color="primary" (click)="openQuestionairePopUp({}, true)">{{"Ежедневная анкета" | translate }}</button>
  <!--  <button *ngIf="getUserRole() === 'Doctor'" mat-raised-button class="mb-8" color="primary" (click)="openAddingPacientPopUp({}, true)"> {{"Добавить пациента" | translate }}</button>
  -->
  <button *ngIf="getUserRole() === 'Admin'" mat-raised-button class="mb-8" color="primary" (click)="openAddingDoctorPopUp({}, true)"> {{"Добавить доктора" | translate }}</button>
</div>

<!--TABLE FOR DOCTOR-->


<div class="messages-wrap" *ngIf="getUserRole() === 'Doctor'">
  <div class="example-header">
    <mat-form-field>
      <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
    </mat-form-field>
  </div>
  <div class="example-container mat-elevation-z8">
    <mat-table #table [dataSource]="dataSource">
      <!--- Note that these columns can be defined in any order.
      The actual rendered columns are set as a property on the row definition" -->
      <!-- Position Column -->
      <ng-container matColumnDef="fullname">
        <mat-header-cell *matHeaderCellDef> Ф.И.О. Пациента </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.fullname}} </mat-cell>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="qDate">
        <mat-header-cell *matHeaderCellDef> Дата заполнения </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.qDate | date: 'medium'}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="temperature">
        <mat-header-cell *matHeaderCellDef> Температура </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <mat-chip mat-sm-chip [color]="'primary'" [selected]="element.temperature > 36.6">{{element.temperature}}</mat-chip>
        </mat-cell>
      </ng-container>

      <!-- Weight Column -->
      <ng-container matColumnDef="headache">
        <mat-header-cell *matHeaderCellDef> Головная боль </mat-header-cell>
        <!--<mat-cell *matCellDef="let element"> {{element.headache}} </mat-cell>-->
        <mat-cell *matCellDef="let element">
          <mat-chip mat-sm-chip [color]="'primary'" [selected]="element.headache">{{element?.headache ? 'Да' : 'Нет'}}</mat-chip>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="obstructedBreathing">
        <mat-header-cell *matHeaderCellDef> Затруднённое дыхание</mat-header-cell>
        <mat-cell *matCellDef="let element">
          <mat-chip mat-sm-chip [color]="'primary'" [selected]="element.obstructedBreathing">{{element?.obstructedBreathing ? 'Да' : 'Нет'}}</mat-chip>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="tiredness">
        <mat-header-cell *matHeaderCellDef> Усталость </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <mat-chip mat-sm-chip [color]="'primary'" [selected]="element.tiredness">{{element?.tiredness ? 'Да' : 'Нет'}}</mat-chip>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;" matRipple class="element-row" [cdkDetailRow]="row" [cdkDetailRowTpl]="tpl">
      </mat-row>
    </mat-table>
    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
  </div>
              
  <ng-template #tpl let-element>
    <div class="mat-row detail-row" [@detailExpand] style="overflow: hidden">
      <p style="background-color: #AED6F1; margin-left: 25px ">Самочувствие</p>
      <p style="margin-left: 25px">{{element.comments}} </p>
    </div>
  </ng-template>
</div>

  <!--TABLE FOR PATIENT-->
  <mat-card *ngIf="getUserRole() === 'User'" class="p-0" [@animate]="{value:'*',params:{y:'50px',delay:'300ms'}}">
    <mat-card-content class="p-0">
      <ngx-datatable class="material ml-0 mr-0"
                     [rows]="questionaries"
                     [columnMode]="'force'"
                     [headerHeight]="50"
                     [footerHeight]="50"
                     [scrollbarH]="true"
                     [limit]="10"
                     [rowHeight]="50">
        <ngx-datatable-column name="Дата заполнения" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.date | date: 'medium' }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Температура" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.temperature }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Самочувствие" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.comments }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Головная боль" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <mat-chip mat-sm-chip [color]="'primary'" [selected]="row.headache">{{row?.headache ? 'Да' : 'Нет'}}</mat-chip>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Затруднённое дыхание" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <mat-chip mat-sm-chip [color]="'primary'" [selected]="row.obstructedBreathing">{{row?.obstructedBreathing ? 'Да' : 'Нет'}}</mat-chip>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Усталость" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <mat-chip mat-sm-chip [color]="'primary'" [selected]="row.tiredness">{{row?.tiredness ? 'Да' : 'Нет'}}</mat-chip>
          </ng-template>
        </ngx-datatable-column>

      </ngx-datatable>
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="getUserRole() === 'User'" class="p-0" [@animate]="{value:'*',params:{y:'50px',delay:'300ms'}}">
    <mat-card-content class="p-0">
      <ngx-datatable class="material ml-0 mr-0"
                     [rows]="appointments"
                     [columnMode]="'force'"
                     [headerHeight]="50"
                     [footerHeight]="50"
                     [scrollbarH]="true"
                     [limit]="10"
                     [rowHeight]="50">
        <ngx-datatable-column name="Препарат" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.pill }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Дата начала приёма" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.startDate | date:'medium' }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Дата завершения приёма" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.endDate | date:'medium' }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Способ применения" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.appointmentDescription }}
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </mat-card-content>
  </mat-card>

  <!--TABLE FOR ADMIN-->
  <mat-card *ngIf="getUserRole() === 'Admin'" class="p-0" [@animate]="{value:'*',params:{y:'50px',delay:'300ms'}}">
    <mat-card-content class="p-0">
      <ngx-datatable class="material ml-0 mr-0"
                     [rows]="doctors"
                     [columnMode]="'force'"
                     [headerHeight]="50"
                     [footerHeight]="50"
                     [scrollbarH]="true"
                     [limit]="10"
                     [rowHeight]="50">
        <ngx-datatable-column name="Доктор" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.fullName}}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Номер телефона" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.phoneNumber }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Электронная почта" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.email }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Стаж работы" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ row?.workExperience }}
          </ng-template>
        </ngx-datatable-column>

        <!--добавить disabled or enabled-->
        <ngx-datatable-column name="Статус" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <mat-chip mat-sm-chip [color]="'primary'" [selected]="row.isActive">{{row.isActive ? 'Активирован' : 'Деактивирован'}}</mat-chip>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Изменить статус" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <button mat-icon-button mat-sm-button color="primary" (click)="changeUserActivation(row)">{{ row.isActive ? 'Деактивировать' : 'Активировать' }}</button>
          </ng-template>
        </ngx-datatable-column>
       </ngx-datatable>
    </mat-card-content>
  </mat-card>



